<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE PATCHWORK: AMERICA 2035</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #000;
            color: #0f0;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        #game-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #111;
            padding: 20px;
            border: 1px solid #0f0;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
        }
        #output {
            height: 400px;
            overflow-y: auto;
            background-color: #000;
            padding: 10px;
            border: 1px solid #0f0;
            margin-bottom: 10px;
            white-space: pre-wrap;
        }
        #input-container {
            display: flex;
        }
        #input {
            flex-grow: 1;
            background-color: #000;
            color: #0f0;
            border: 1px solid #0f0;
            padding: 5px 10px;
            font-family: 'Courier New', monospace;
        }
        #submit {
            background-color: #0f0;
            color: #000;
            border: none;
            padding: 5px 15px;
            margin-left: 10px;
            cursor: pointer;
        }
        #commands {
            margin-top: 20px;
            padding: 10px;
            background-color: #111;
            border: 1px solid #0f0;
        }
        .command-btn {
            background-color: #000;
            color: #0f0;
            border: 1px solid #0f0;
            padding: 5px 10px;
            margin: 5px;
            cursor: pointer;
        }
        .command-btn:hover {
            background-color: #0f0;
            color: #000;
        }
        .cyan { color: cyan; }
        .yellow { color: yellow; }
        .red { color: red; }
        .green { color: lightgreen; }
        .white { color: white; }
        .magenta { color: magenta; }
        .ascii-art {
            font-family: monospace;
            white-space: pre;
        }
        #patch-selection {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background-color: #111;
            border: 1px solid #0f0;
        }
        .patch-option {
            margin: 10px 0;
            padding: 10px;
            background-color: #000;
            border: 1px solid #0f0;
            cursor: pointer;
        }
        .patch-option:hover {
            background-color: #0a0a0a;
        }
        .patch-option.selected {
            background-color: #003300;
            border: 1px solid #0f0;
        }
        #selection-counter {
            margin-top: 10px;
            font-weight: bold;
        }
        #confirm-selection {
            margin-top: 15px;
            padding: 8px 15px;
            background-color: #0f0;
            color: #000;
            border: none;
            cursor: pointer;
            display: block;
        }
        #confirm-selection:disabled {
            background-color: #005500;
            color: #333;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <h1 class="cyan">THE PATCHWORK: AMERICA 2035</h1>
        <div id="output"></div>
        <div id="input-container">
            <input type="text" id="input" placeholder="Type your command here...">
            <button id="submit">Submit</button>
        </div>
        <div id="commands">
            <h3 class="yellow">Quick Commands:</h3>
            <button class="command-btn" onclick="sendCommand('BEGIN SESSION')">BEGIN SESSION</button>
            <button class="command-btn" onclick="sendCommand('BEGIN GAME')">BEGIN GAME</button>
            <button class="command-btn" onclick="sendCommand('END SESSION')">END SESSION</button>
            <button class="command-btn" onclick="sendCommand('TRAVEL')">TRAVEL</button>
            <button class="command-btn" onclick="sendCommand('EXPLORE')">EXPLORE</button>
            <button class="command-btn" onclick="sendCommand('INVESTIGATE')">INVESTIGATE</button>
            <button class="command-btn" onclick="sendCommand('INTERACT')">INTERACT</button>
            <button class="command-btn" onclick="sendCommand('CONVERSATE')">CONVERSATE</button>
            <button class="command-btn" onclick="sendCommand('DISPLAY MAP')">DISPLAY MAP</button>
        </div>
        
        <!-- Patch Selection Interface -->
        <div id="patch-selection">
            <h3 class="cyan">Select up to 3 PATCHES to include in your journey:</h3>
            <div id="patch-options"></div>
            <div id="selection-counter" class="yellow">Selected: 0/3</div>
            <button id="confirm-selection" disabled>Confirm Selection</button>
        </div>
    </div>

    <script>
        // Game state
        const gameState = {
            session: false,
            gameStarted: false,
            currentPatch: null,
            currentLandmark: null,
            currentEntity: null,
            tooCurious: 0,
            patches: [],
            entities: [],
            selectedPatches: [],
            patchSelectionComplete: false
        };

        // ASCII Maps
        const asciiMaps = {
            patch1: `
+------------------------------+
|            PATCH 1           |
|             "X"              |
|                              |
|    [L1]----[L2]              |
|     |                        |
|    [L3]                      |
|                              |
+------------------------------+`,
            patch2: `
+------------------------------+
|            PATCH 2           |
|           "PRIME"            |
|                              |
|    [L1]----[L2]----[L3]      |
|                              |
|                              |
|                              |
+------------------------------+`,
            patch3: `
+------------------------------+
|            PATCH 3           |
|         "BALAJISTAN"         |
|                              |
|    [L1]                      |
|     |                        |
|    [L2]----[L3]              |
|                              |
+------------------------------+`,
            patch4: `
+------------------------------+
|            PATCH 4           |
|           "PRAXIA"           |
|                              |
|    [L1]----[L3]              |
|     |                        |
|    [L2]                      |
|                              |
+------------------------------+`,
            patch5: `
+------------------------------+
|            PATCH 5           |
|        "JEFFERSONIAN"        |
|                              |
|    [L1]----[L2]              |
|             |                |
|            [L3]              |
|                              |
+------------------------------+`,
            patch6: `
+------------------------------+
|            PATCH 6           |
|      "THE WALLED GARDEN"     |
|                              |
|    [L1]                      |
|     |                        |
|    [L2]----[L3]              |
|                              |
+------------------------------+`,
            landmark: `
+------------------------------+
|           LANDMARK           |
|                              |
|    [C1]    [O1]              |
|                              |
|    [O2]    [C2]              |
|                              |
+------------------------------+`
        };

        // All available patches
        const allPatches = [
            {
                number: 1,
                name: "X",
                motto: "Efficiency through elimination of choice.",
                location: "Former Silicon Valley, California",
                overview: "A minimalist society where all choices are optimized away.",
                landmarks: [
                    {
                        number: 1,
                        name: "The Hub",
                        description: "The central administrative district of X, featuring stark white buildings with no ornamentation.",
                        entities: [
                            { type: "CITIZEN", number: 1, name: "Efficiency Officer", description: "A person in a plain gray uniform who monitors productivity metrics." },
                            { type: "OBJECT", number: 1, name: "Minimalist Terminal", description: "A sleek white terminal with a single button." }
                        ]
                    },
                    {
                        number: 2,
                        name: "Residential Block A",
                        description: "Identical white cubes serve as housing units, arranged in a perfect grid.",
                        entities: [
                            { type: "CITIZEN", number: 2, name: "Resident 1729", description: "A citizen wearing the standard gray jumpsuit of X." },
                            { type: "OBJECT", number: 2, name: "Nutrition Dispenser", description: "A machine that provides perfectly balanced nutrient paste." }
                        ]
                    },
                    {
                        number: 3,
                        name: "Production Zone",
                        description: "An automated factory where robots assemble products with perfect precision.",
                        entities: [
                            { type: "CITIZEN", number: 3, name: "Maintenance Technician", description: "A person responsible for keeping the automation running smoothly." },
                            { type: "OBJECT", number: 3, name: "Assembly Robot", description: "A robot arm that performs repetitive tasks with perfect accuracy." }
                        ]
                    }
                ]
            },
            {
                number: 2,
                name: "PRIME",
                motto: "Only the numbers that matter.",
                location: "Former Seattle, Washington",
                overview: "A society organized around mathematical principles and optimization algorithms.",
                landmarks: [
                    {
                        number: 1,
                        name: "Algorithm Plaza",
                        description: "A public square where massive displays show constantly updating equations and formulas.",
                        entities: [
                            { type: "CITIZEN", number: 1, name: "Data Analyst", description: "A person staring intently at floating holographic numbers." },
                            { type: "OBJECT", number: 1, name: "Calculation Pillar", description: "A tall obelisk covered in mathematical symbols that change patterns." }
                        ]
                    },
                    {
                        number: 2,
                        name: "Quantum Computing Center",
                        description: "A facility housing advanced quantum computers that solve complex problems.",
                        entities: [
                            { type: "CITIZEN", number: 2, name: "Quantum Engineer", description: "A person monitoring the delicate quantum states of the computers." },
                            { type: "OBJECT", number: 2, name: "Quantum Core", description: "A shimmering cube suspended in a vacuum chamber." }
                        ]
                    },
                    {
                        number: 3,
                        name: "Fibonacci Gardens",
                        description: "A park designed with perfect mathematical proportions and spiral patterns.",
                        entities: [
                            { type: "CITIZEN", number: 3, name: "Garden Mathematician", description: "A person carefully trimming plants to maintain perfect ratios." },
                            { type: "OBJECT", number: 3, name: "Golden Ratio Sculpture", description: "A metallic sculpture that embodies the golden ratio in its design." }
                        ]
                    }
                ]
            },
            {
                number: 3,
                name: "BALAJISTAN",
                motto: "Disruption as a way of life.",
                location: "Former Austin, Texas",
                overview: "A chaotic society built on constant innovation and creative destruction.",
                landmarks: [
                    {
                        number: 1,
                        name: "Pivot Plaza",
                        description: "A constantly changing public space where buildings are demolished and rebuilt weekly.",
                        entities: [
                            { type: "CITIZEN", number: 1, name: "Serial Entrepreneur", description: "A person frantically pitching ideas to anyone who will listen." },
                            { type: "OBJECT", number: 1, name: "Idea Generator", description: "A machine that randomly combines words to create startup concepts." }
                        ]
                    },
                    {
                        number: 2,
                        name: "The Incubator",
                        description: "A massive complex where thousands of startups compete for resources.",
                        entities: [
                            { type: "CITIZEN", number: 2, name: "Venture Capitalist", description: "A person in expensive clothes evaluating pitches with cold calculation." },
                            { type: "OBJECT", number: 2, name: "Funding Terminal", description: "A device that dispenses investment capital based on algorithmic predictions." }
                        ]
                    },
                    {
                        number: 3,
                        name: "Failure Museum",
                        description: "A monument to celebrated startup failures, seen as badges of honor.",
                        entities: [
                            { type: "CITIZEN", number: 3, name: "Failure Coach", description: "A person who helps entrepreneurs reframe their failures as learning experiences." },
                            { type: "OBJECT", number: 3, name: "Pivot Machine", description: "A device that helps failing startups find new directions." }
                        ]
                    }
                ]
            },
            {
                number: 4,
                name: "PRAXIA",
                motto: "Practical solutions for practical people.",
                location: "Former Chicago, Illinois",
                overview: "A pragmatic society focused on tangible results and real-world applications.",
                landmarks: [
                    {
                        number: 1,
                        name: "Implementation Center",
                        description: "A hub where ideas are rigorously tested for practical application.",
                        entities: [
                            { type: "CITIZEN", number: 1, name: "Efficiency Expert", description: "A person with a clipboard measuring and optimizing workflows." },
                            { type: "OBJECT", number: 1, name: "Practicality Gauge", description: "A device that measures the real-world utility of concepts." }
                        ]
                    },
                    {
                        number: 2,
                        name: "Solution Workshops",
                        description: "Facilities where teams work on solving specific problems with measurable outcomes.",
                        entities: [
                            { type: "CITIZEN", number: 2, name: "Problem Solver", description: "A person wearing work clothes with various tools attached to their belt." },
                            { type: "OBJECT", number: 2, name: "Iteration Machine", description: "A device that rapidly prototypes and tests solutions." }
                        ]
                    },
                    {
                        number: 3,
                        name: "Results Park",
                        description: "A space showcasing successful implementations that improved quality of life.",
                        entities: [
                            { type: "CITIZEN", number: 3, name: "Outcome Assessor", description: "A person measuring and documenting the impact of various solutions." },
                            { type: "OBJECT", number: 3, name: "Impact Calculator", description: "A machine that quantifies the real-world benefits of implemented solutions." }
                        ]
                    }
                ]
            },
            {
                number: 5,
                name: "JEFFERSONIAN",
                motto: "Democracy reimagined for the digital age.",
                location: "Former Washington D.C.",
                overview: "A society built on direct digital democracy and transparent governance.",
                landmarks: [
                    {
                        number: 1,
                        name: "Consensus Hall",
                        description: "A massive circular building where citizens participate in continuous voting.",
                        entities: [
                            { type: "CITIZEN", number: 1, name: "Digital Citizen", description: "A person wearing augmented reality glasses constantly reviewing and voting on proposals." },
                            { type: "OBJECT", number: 1, name: "Voting Terminal", description: "A secure device that allows citizens to vote on any issue at any time." }
                        ]
                    },
                    {
                        number: 2,
                        name: "Transparency Tower",
                        description: "A glass building where all governance happens in full public view.",
                        entities: [
                            { type: "CITIZEN", number: 2, name: "Public Servant", description: "A person whose work and communications are livestreamed to all citizens." },
                            { type: "OBJECT", number: 2, name: "Oversight Display", description: "A screen showing real-time data on all government activities and spending." }
                        ]
                    },
                    {
                        number: 3,
                        name: "Deliberation Gardens",
                        description: "A peaceful space designed for thoughtful discussion of public issues.",
                        entities: [
                            { type: "CITIZEN", number: 3, name: "Debate Moderator", description: "A person who facilitates respectful discussion between citizens with opposing views." },
                            { type: "OBJECT", number: 3, name: "Fact-Checking Kiosk", description: "A terminal that provides verified information on topics being discussed." }
                        ]
                    }
                ]
            },
            {
                number: 6,
                name: "THE WALLED GARDEN",
                motto: "Safety and comfort within our walls.",
                location: "Former San Francisco, California",
                overview: "A carefully curated society where all experiences are designed to be pleasant and safe.",
                landmarks: [
                    {
                        number: 1,
                        name: "Curation Center",
                        description: "A facility where all content and experiences are reviewed before being allowed in the community.",
                        entities: [
                            { type: "CITIZEN", number: 1, name: "Content Curator", description: "A person who reviews and approves all media for community consumption." },
                            { type: "OBJECT", number: 1, name: "Sentiment Analyzer", description: "A machine that scans content for potentially upsetting material." }
                        ]
                    },
                    {
                        number: 2,
                        name: "Comfort Quarters",
                        description: "Residential areas designed to eliminate all sources of stress or discomfort.",
                        entities: [
                            { type: "CITIZEN", number: 2, name: "Wellness Monitor", description: "A person who checks in on residents to ensure their complete satisfaction." },
                            { type: "OBJECT", number: 2, name: "Mood Regulator", description: "A device that adjusts lighting, temperature, and ambient sound for optimal comfort." }
                        ]
                    },
                    {
                        number: 3,
                        name: "Harmony Plaza",
                        description: "A public space where all interactions are monitored to prevent conflict.",
                        entities: [
                            { type: "CITIZEN", number: 3, name: "Conflict Resolver", description: "A person trained to intervene at the first sign of disagreement." },
                            { type: "OBJECT", number: 3, name: "Harmony Beacon", description: "A pillar that emits subtle signals to promote calm and agreement." }
                        ]
                    }
                ]
            }
        ];

        // DOM Elements
        const output = document.getElementById('output');
        const input = document.getElementById('input');
        const submit = document.getElementById('submit');
        const patchSelection = document.getElementById('patch-selection');
        const patchOptions = document.getElementById('patch-options');
        const selectionCounter = document.getElementById('selection-counter');
        const confirmSelection = document.getElementById('confirm-selection');

        // Initialize patch selection interface
        function initializePatchSelection() {
            // Clear previous options
            patchOptions.innerHTML = '';
            
            // Create option for each patch
            allPatches.forEach(patch => {
                const option = document.createElement('div');
                option.className = 'patch-option';
                option.dataset.patchNumber = patch.number;
                option.innerHTML = `
                    <h4>PATCH ${patch.number}: ${patch.name}</h4>
                    <p><strong>Motto:</strong> ${patch.motto}</p>
                    <p><strong>Location:</strong> ${patch.location}</p>
                    <p>${patch.overview}</p>
                `;
                
                // Add click event to select/deselect
                option.addEventListener('click', () => {
                    togglePatchSelection(patch, option);
                });
                
                patchOptions.appendChild(option);
            });
            
            // Show the patch selection interface
            patchSelection.style.display = 'block';
            
            // Initialize confirm button
            confirmSelection.addEventListener('click', confirmPatchSelections);
        }

        // Toggle patch selection
        function togglePatchSelection(patch, optionElement) {
            const index = gameState.selectedPatches.findIndex(p => p.number === patch.number);
            
            if (index === -1) {
                // Not selected, try to select it
                if (gameState.selectedPatches.length < 3) {
                    gameState.selectedPatches.push(patch);
                    optionElement.classList.add('selected');
                } else {
                    print('You can only select up to 3 PATCHES.', 'red');
                }
            } else {
                // Already selected, deselect it
                gameState.selectedPatches.splice(index, 1);
                optionElement.classList.remove('selected');
            }
            
            // Update counter
            selectionCounter.textContent = `Selected: ${gameState.selectedPatches.length}/3`;
            
            // Enable/disable confirm button
            confirmSelection.disabled = gameState.selectedPatches.length === 0;
        }

        // Confirm patch selections
        function confirmPatchSelections() {
            if (gameState.selectedPatches.length === 0) {
                print('You must select at least one PATCH.', 'red');
                return;
            }
            
            // Hide selection interface
            patchSelection.style.display = 'none';
            
            // Set selected patches as game patches
            gameState.patches = [...gameState.selectedPatches];
            gameState.patchSelectionComplete = true;
            
            // Display selected patches
            print('\nYou have selected the following PATCHES:', 'cyan');
            gameState.patches.forEach(patch => {
                print(`PATCH ${patch.number}: ${patch.name} - ${patch.motto}`, 'green');
            });
            
            // Continue with game initialization
            initializeGame();
            
            // Display current patch information
            displayCurrentPatch();
        }

        // Output functions
        function print(text, className = '') {
            const span = document.createElement('span');
            span.className = className;
            span.textContent = text + '\n';
            output.appendChild(span);
            output.scrollTop = output.scrollHeight;
        }

        function printHTML(html) {
            const div = document.createElement('div');
            div.innerHTML = html;
            output.appendChild(div);
            output.scrollTop = output.scrollHeight;
        }

        function clearOutput() {
            output.innerHTML = '';
        }

        // Initialize game data
        function initializeGame() {
            // Set initial patch and landmark
            gameState.currentPatch = gameState.patches[0]; // First selected patch
            gameState.currentLandmark = gameState.currentPatch.landmarks[0]; // Landmark 1
            gameState.entities = gameState.currentLandmark.entities;
        }

        // Display current patch information
        function displayCurrentPatch() {
            // Display current patch information
            print(`=== PATCH ${gameState.currentPatch.number}: ${gameState.currentPatch.name} ===`, 'cyan');
            print(`Motto: ${gameState.currentPatch.motto}`, 'white');
            print(`Location: ${gameState.currentPatch.location}`, 'white');
            print(`Overview: ${gameState.currentPatch.overview}`, 'white');
            
            // Display current landmark
            print(`\nLandmark ${gameState.currentLandmark.number}: ${gameState.currentLandmark.name}`, 'green');
            print(gameState.currentLandmark.description);
            
            // Display available commands
            print('\nAvailable commands:', 'yellow');
            print('  TRAVEL - Move to an adjacent PATCH');
            print('  EXPLORE - Move to an adjacent LANDMARK within the current PATCH');
            print('  INVESTIGATE - Examine an OBJECT or CITIZEN in the current LANDMARK');
            print('  DISPLAY MAP - Show your current location and movement options');
            
            // Display TOO CURIOUS counter
            print(`\nTOO CURIOUS: ${gameState.tooCurious}/30`, 'red');
        }

        // Command handling
        function handleCommand(command) {
            print('> ' + command, 'white');
            
            const cmd = command.toUpperCase().trim();
            
            // Display TOO CURIOUS counter if game has started
            if (gameState.gameStarted) {
                print(`TOO CURIOUS: ${gameState.tooCurious}/30`, 'red');
            }
            
            // Handle commands
            switch (cmd) {
                case 'BEGIN SESSION':
                    beginSession();
                    break;
                case 'BEGIN GAME':
                    beginGame();
                    break;
                case 'END SESSION':
                    endSession();
                    break;
                case 'TRAVEL':
                    travel();
                    break;
                case 'EXPLORE':
                    explore();
                    break;
                case 'INVESTIGATE':
                    investigate();
                    break;
                case 'INTERACT':
                    interact();
                    break;
                case 'CONVERSATE':
                    conversate();
                    break;
                case 'DISPLAY MAP':
                    displayMap();
                    break;
                default:
                    print('Unknown command. Type BEGIN SESSION to start.', 'yellow');
            }
        }

        // Command implementations
        function beginSession() {
            gameState.session = true;
            
            print('=== THE PATCHWORK: AMERICA 2035 ===', 'cyan');
            print('Welcome to THE PATCHWORK - a fragmented vision of America in 2035, where tech billionaires have carved the nation into corporate PATCHES.', 'yellow');
            print('You are an unmarked nomad, searching for a place to call home.', 'yellow');
            print('In The Patchwork, you move between PATCHES using TRAVEL and navigate between LANDMARKS inside a PATCH using EXPLORE.', 'yellow');
            print('\nBefore you begin your journey, you must select up to 3 PATCHES to explore.', 'cyan');
            
            // Initialize patch selection
            initializePatchSelection();
        }

        function beginGame() {
            if (!gameState.session) {
                print('You must start a session first. Type BEGIN SESSION.', 'yellow');
                return;
            }
            
            if (!gameState.patchSelectionComplete) {
                print('You must select your PATCHES first.', 'yellow');
                // Show selection interface if it's hidden
                patchSelection.style.display = 'block';
                return;
            }
            
            gameState.gameStarted = true;
            gameState.tooCurious = 0;
            
            // Display current location
            displayCurrentPatch();
        }

        function endSession() {
            gameState.session = false;
            gameState.gameStarted = false;
            gameState.patchSelectionComplete = false;
            gameState.selectedPatches = [];
            
            print('Ending your session in The Patchwork. Your progress has been saved.', 'cyan');
            print('Type BEGIN SESSION to start a new journey.', 'yellow');
        }

        function travel() {
            if (!gameState.gameStarted) {
                print('You must start the game first. Type BEGIN SESSION, then BEGIN GAME.', 'yellow');
                return;
            }
            
            if (gameState.patches.length === 1) {
                print('You only selected one PATCH. There are no other PATCHES to travel to.', 'yellow');
                return;
            }
            
            const currentIndex = gameState.patches.findIndex(p => p.number === gameState.currentPatch.number);
            
            print('Available PATCHES to travel to:', 'cyan');
            
            // List all patches except current one
            let optionNumber = 1;
            const travelOptions = [];
            
            gameState.patches.forEach((patch, index) => {
                if (index !== currentIndex) {
                    print(`  ${optionNumber}. PATCH ${patch.number}: ${patch.name}`, 'white');
                    travelOptions.push(patch);
                    optionNumber++;
                }
            });
            
            print('\nEnter a number to choose your destination.', 'yellow');
            
            // Simulate choice (in a real implementation, this would wait for user input)
            setTimeout(() => {
                // For demo purposes, always choose option 1
                print('> 1', 'white');
                
                // Move to the selected patch, landmark 1
                const selectedPatch = travelOptions[0];
                gameState.currentPatch = selectedPatch;
                gameState.currentLandmark = gameState.currentPatch.landmarks[0];
                gameState.entities = gameState.currentLandmark.entities;
                
                // Display new location
                print(`You travel to PATCH ${gameState.currentPatch.number}: ${gameState.currentPatch.name}`, 'cyan');
                displayCurrentPatch();
            }, 2000);
        }

        function explore() {
            if (!gameState.gameStarted) {
                print('You must start the game first. Type BEGIN SESSION, then BEGIN GAME.', 'yellow');
                return;
            }
            
            const landmarks = gameState.currentPatch.landmarks;
            const currentIndex = gameState.currentLandmark.number - 1;
            
            print('Available LANDMARKS to explore:', 'cyan');
            
            // List all landmarks except current one
            let optionNumber = 1;
            const exploreOptions = [];
            
            landmarks.forEach((landmark, index) => {
                if (index !== currentIndex) {
                    print(`  ${optionNumber}. Landmark ${landmark.number}: ${landmark.name}`, 'white');
                    exploreOptions.push(landmark);
                    optionNumber++;
                }
            });
            
            print('\nEnter a number to choose your destination.', 'yellow');
            
            // Simulate choice (in a real implementation, this would wait for user input)
            setTimeout(() => {
                // For demo purposes, always choose option 1
                print('> 1', 'white');
                
                // Move to the selected landmark
                const selectedLandmark = exploreOptions[0];
                gameState.currentLandmark = selectedLandmark;
                gameState.entities = gameState.currentLandmark.entities;
                
                // Display new location
                print(`You explore to Landmark ${gameState.currentLandmark.number}: ${gameState.currentLandmark.name}`, 'green');
                print(`\nLandmark ${gameState.currentLandmark.number}: ${gameState.currentLandmark.name}`, 'green');
                print(gameState.currentLandmark.description);
                
                // Display TOO CURIOUS counter
                print(`\nTOO CURIOUS: ${gameState.tooCurious}/30`, 'red');
            }, 2000);
        }

        function investigate() {
            if (!gameState.gameStarted) {
                print('You must start the game first. Type BEGIN SESSION, then BEGIN GAME.', 'yellow');
                return;
            }
            
            const entities = gameState.currentLandmark.entities;
            
            if (entities.length === 0) {
                print('There is nothing to investigate here.', 'yellow');
                return;
            }
            
            // If no current entity, start with the first one
            let nextEntityIndex = 0;
            if (gameState.currentEntity) {
                const currentIndex = entities.findIndex(e => 
                    e.type === gameState.currentEntity.type && e.number === gameState.currentEntity.number);
                nextEntityIndex = (currentIndex + 1) % entities.length;
            }
            
            gameState.currentEntity = entities[nextEntityIndex];
            
            // Display entity information
            if (gameState.currentEntity.type === 'CITIZEN') {
                print(`Citizen: ${gameState.currentEntity.name}`, 'yellow');
            } else {
                print(`Object: ${gameState.currentEntity.name}`, 'magenta');
            }
            print(gameState.currentEntity.description);
            
            // Display TOO CURIOUS counter
            print(`\nTOO CURIOUS: ${gameState.tooCurious}/30`, 'red');
        }

        function interact() {
            if (!gameState.gameStarted) {
                print('You must start the game first. Type BEGIN SESSION, then BEGIN GAME.', 'yellow');
                return;
            }
            
            if (!gameState.currentEntity) {
                print('You must first INVESTIGATE an object to interact with.', 'yellow');
                return;
            }
            
            if (gameState.currentEntity.type !== 'OBJECT') {
                print('You can only INTERACT with OBJECTS. Use CONVERSATE with CITIZENS.', 'yellow');
                return;
            }
            
            // Increment TOO CURIOUS counter
            gameState.tooCurious++;
            
            // Check for execution
            if (gameState.tooCurious >= 30) {
                executePlayer();
                return;
            }
            
            // Display interaction
            print(`You interact with ${gameState.currentEntity.name}.`, 'magenta');
            print('[Object interaction not yet fully implemented]', 'red');
            
            // Display TOO CURIOUS counter
            print(`\nTOO CURIOUS: ${gameState.tooCurious}/30`, 'red');
        }

        function conversate() {
            if (!gameState.gameStarted) {
                print('You must start the game first. Type BEGIN SESSION, then BEGIN GAME.', 'yellow');
                return;
            }
            
            if (!gameState.currentEntity) {
                print('You must first INVESTIGATE a citizen to talk with.', 'yellow');
                return;
            }
            
            if (gameState.currentEntity.type !== 'CITIZEN') {
                print('You can only CONVERSATE with CITIZENS. Use INTERACT with OBJECTS.', 'yellow');
                return;
            }
            
            // Increment TOO CURIOUS counter
            gameState.tooCurious++;
            
            // Check for execution
            if (gameState.tooCurious >= 30) {
                executePlayer();
                return;
            }
            
            // Display conversation
            print(`You talk with ${gameState.currentEntity.name}.`, 'yellow');
            print(`${gameState.currentEntity.name} says: "Hello there."`, 'yellow');
            print('[Dialogue not yet fully implemented]', 'red');
            
            // Display TOO CURIOUS counter
            print(`\nTOO CURIOUS: ${gameState.tooCurious}/30`, 'red');
        }

        function displayMap() {
            if (!gameState.gameStarted) {
                print('You must start the game first. Type BEGIN SESSION, then BEGIN GAME.', 'yellow');
                return;
            }
            
            // Display TOO CURIOUS counter
            print(`TOO CURIOUS: ${gameState.tooCurious}/30`, 'red');
            
            // Display current location
            print('\nYou are currently in:', 'cyan');
            print(`  PATCH ${gameState.currentPatch.number}: ${gameState.currentPatch.name}`);
            print(`  Landmark ${gameState.currentLandmark.number}: ${gameState.currentLandmark.name}`);
            
            // Display ASCII map
            print('\nPATCH MAP:', 'cyan');
            print(asciiMaps[`patch${gameState.currentPatch.number}`], 'ascii-art');
            
            print('\nLANDMARK MAP:', 'cyan');
            print(asciiMaps.landmark, 'ascii-art');
            
            // Display available patches to travel to
            if (gameState.patches.length > 1) {
                const currentIndex = gameState.patches.findIndex(p => p.number === gameState.currentPatch.number);
                
                print('\nAvailable PATCHES to travel to (use TRAVEL command):', 'cyan');
                
                gameState.patches.forEach((patch, index) => {
                    if (index !== currentIndex) {
                        print(`  - PATCH ${patch.number}: ${patch.name}`);
                    }
                });
            } else {
                print('\nYou only selected one PATCH. There are no other PATCHES to travel to.', 'yellow');
            }
            
            // Display adjacent landmarks
            const landmarks = gameState.currentPatch.landmarks;
            const currentLandmarkIndex = gameState.currentLandmark.number - 1;
            
            print('\nAvailable LANDMARKS to explore (use EXPLORE command):', 'cyan');
            
            landmarks.forEach((landmark, index) => {
                if (index !== currentLandmarkIndex) {
                    print(`  - Landmark ${landmark.number}: ${landmark.name}`);
                }
            });
            
            // Display entities in current landmark
            print('\nEntities in this LANDMARK (use INVESTIGATE to examine):', 'cyan');
            if (gameState.entities.length > 0) {
                gameState.entities.forEach(entity => {
                    if (entity.type === 'CITIZEN') {
                        print(`  - Citizen: ${entity.name}`, 'yellow');
                    } else {
                        print(`  - Object: ${entity.name}`, 'magenta');
                    }
                });
            } else {
                print('  None');
            }
        }

        function executePlayer() {
            print('You have become TOO CURIOUS!', 'red');
            print(`The authorities in PATCH ${gameState.currentPatch.number}: ${gameState.currentPatch.name} have deemed you a threat.`, 'red');
            print('You are executed according to the local customs.', 'red');
            print('GAME OVER', 'red');
            
            // Reset game
            gameState.gameStarted = false;
            gameState.session = false;
            gameState.patchSelectionComplete = false;
            gameState.selectedPatches = [];
            
            print('\nType BEGIN SESSION to try again.', 'yellow');
        }

        // Event listeners
        submit.addEventListener('click', () => {
            const command = input.value.trim();
            if (command) {
                handleCommand(command);
                input.value = '';
            }
        });

        input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const command = input.value.trim();
                if (command) {
                    handleCommand(command);
                    input.value = '';
                }
            }
        });

        function sendCommand(command) {
            handleCommand(command);
        }

        // Initial message
        print('Welcome to THE PATCHWORK: AMERICA 2035', 'cyan');
        print('Type BEGIN SESSION to start your journey.', 'yellow');
    </script>
</body>
</html>
